
<view class="login-container">
  <view class="weui-cells weui-cells_after-title">
    <view class="weui-cell weui-cell_access">
      <view class="weui-cell__hd">
        <mp-icon type="safe" size="20" color="#07C160"></mp-icon>
      </view>
      <view class="weui-cell__bd">
        <text class="weui-label">健管师服务管理信息系统</text>
      </view>
    </view>
  </view>

  <!-- 使用原生form组件替代mp-form，确保事件绑定可靠 -->
  <form bindsubmit="handleLogin">
    <mp-cells>
      <mp-cell>
        <view class="weui-label">账号</view>
        <input 
          name="username" 
          type="text" 
          placeholder="请输入账号" 
          value="{{formData.username}}" 
          bindinput="onInputChange" 
          data-field="username"
          class="weui-input"
          disabled="{{loading}}"
        />
      </mp-cell>

      <mp-cell>
        <view class="weui-label">密码</view>
        <view class="weui-input-group">
          <input 
            name="password" 
            type="{{showPassword ? 'text' : 'password'}}" 
            placeholder="请输入密码" 
            value="{{formData.password}}" 
            bindinput="onInputChange" 
            data-field="password"
            class="weui-input"
            disabled="{{loading}}"
          />
          <view class="weui-icon-btn" bindtap="togglePassword">
            <mp-icon 
              type="{{showPassword ? 'eye' : 'eye-close'}}" 
              size="20" 
              color="#999"
            ></mp-icon>
          </view>
        </view>
      </mp-cell>
    </mp-cells>

    <view class="weui-btn-area">
      <button 
        formType="submit" 
        class="weui-btn weui-btn_primary" 
        disabled="{{loading}}"
        loading="{{loading}}"
        bindtap="testButtonClick"
      >
        {{loading ? '登录中...' : '登录'}}
      </button>
      
      <!-- 添加测试按钮，用于调试 -->
      <button 
        class="weui-btn weui-btn_default" 
        style="margin-top: 20rpx;"
        bindtap="testButtonClick"
      >
        测试按钮点击
      </button>
    </view>
  </form>

  <view class="weui-footer">
    <view class="weui-footer__text">账号申请：联系系统开发人员或管理员</view>
  </view>
</view>
