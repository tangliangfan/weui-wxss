
<!-- 页面容器 -->
<view class="container">
  <!-- 搜索栏区域 - 使用 WeUI 搜索栏 -->
  <mp-search-bar 
    placeholder="搜索姓名、手机号或小区名称..." 
    value="{{searchText}}" 
    bindinput="onSearchInput"
    bindsearch="handleSearch"
    bindclear="onSearchClear"
    class="custom-search-bar"
  />

  <!-- 添加用户按钮区域 - 使用 WeUI 按钮 -->
  <view class="weui-btn-area">
    <button class="weui-btn weui-btn_primary" bindtap="handleAddUser">
      <mp-icon type="add" size="16" color="#fff"></mp-icon>
      添加新用户
    </button>
  </view>

  <!-- 用户列表区域 -->
  <view class="user-list">
    <!-- 列表头部 -->
    <view class="weui-cells__title">
      <text>待随访用户</text>
      <text class="weui-cells__title-extra">{{filteredUsers.length}} 位</text>
    </view>

    <!-- 加载中状态显示 -->
    <view wx:if="{{loading}}" class="weui-loadmore">
      <mp-loading type="circle" size="20"></mp-loading>
      <view class="weui-loadmore__tips">加载中...</view>
    </view>

    <!-- 空状态显示 -->
    <view wx:if="{{!loading && filteredUsers.length === 0}}" class="weui-empty">
      <mp-icon type="info" size="48" color="#ccc"></mp-icon>
      <view class="weui-empty__desc">暂无待随访用户</view>
    </view>

    <!-- 用户列表循环渲染 -->
    <mp-cells>
      <mp-cell 
        wx:for="{{filteredUsers}}" 
        wx:key="_id" 
        bindtap="handleUserClick" 
        data-user="{{item}}"
        class="user-cell"
      >
        <!-- 随访时间徽章 -->
        <view 
          wx:if="{{item.followups && item.followups.length > 0 && item.followups[item.followups.length - 1].nextFollowupDate}}" 
          class="weui-badge {{getFollowupTimeClass(item)}}"
          slot="title-extra"
        >
          {{getFollowupTimeText(item)}}
        </view>

        <!-- 用户信息 -->
        <view slot="title">
          <view class="user-name">{{item.name || '未命名用户'}}</view>
          <view class="weui-cell__desc">
            <text>{{item.phone || '未设置手机号'}}</text>
            <text>{{item.address || '未设置地址'}}</text>
          </view>
        </view>

        <!-- 状态标签 -->
        <view slot="footer">
          <view class="weui-badge {{item.statusClass}}">
            {{item.statusText}}
          </view>
        </view>
      </mp-cell>
    </mp-cells>
  </view>
</view>

  <!-- 搜索弹窗模态框 -->
  <view wx:if="{{showSearchModal}}" class="weui-half-screen-dialog weui-half-screen-dialog_show">
    <view class="weui-half-screen-dialog__hd">
      <view class="weui-half-screen-dialog__title">搜索结果</view>
      <view class="weui-half-screen-dialog__subtitle">找到 {{searchResults.length}} 个匹配的用户</view>
    </view>
    <view class="weui-half-screen-dialog__bd">
      <!-- 搜索内容 -->
    </view>
  </view>

  <!-- 添加用户模态框 -->
  <view wx:if="{{showAddUserModal}}" class="weui-dialog weui-dialog_show">
    <view class="weui-dialog__hd">
      <view class="weui-dialog__title">添加新用户</view>
    </view>
    <view class="weui-dialog__bd">
      <mp-form>
        <!-- 表单内容 -->
      </mp-form>
    </view>
  </view>
</view>
  